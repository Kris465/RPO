### **Конспект лекции №18**
**Дисциплина:** Основы информационных технологий
**Тема:** Понятие набора команд (ISA). Наборы x86, x87. Сопроцессор.

---

#### **1. Введение: Язык процессора**

Представьте, что процессор — это очень быстрый, но абсолютно безмозглый исполнитель. Он не умеет думать, он умеет только выполнять простейшие команды. Чтобы управлять им, нам нужен язык, который он понимает. Этот язык и есть **Набор Команд (Instruction Set)**.

---

#### **2. Что такое ISA (Instruction Set Architecture)?**

**ISA (Instruction Set Architecture)** — это договорённость между аппаратным обеспечением (процессором) и программным обеспечением (компиляторами, операционными системами).

*   **Аппаратная часть (Процессор):** Обязуется понимать и выполнять команды, определённые в ISA.
*   **Программная часть (Программа):** Состоит из этих самых команд.

**Что входит в ISA:**
*   **Сам набор команд:** Список всех операций, которые процессор может выполнить (например, `ADD`, `MOV`, `JMP`).
*   **Типы данных:** С какими данными работают команды (целые числа, числа с плавающей точкой).
*   **Регистры:** Ячейки памяти прямо внутри процессора для хранения обрабатываемых данных.
*   **Режимы адресации:** Способы указания, откуда брать данные для операции (из регистра, из памяти, прямое значение).
*   **Обработка исключений:** Как процессор реагирует на ошибки (например, деление на ноль).

**Аналогия:** ISA — это как набор деталей Lego и инструкция по их соединению. Из одного набора (ISA x86) можно построить и маленький домик (простой процессор), и огромный замок (многоядерный серверный CPU), но все они будут совместимы друг с другом.

---

#### **3. ISA x86: Динозавр, который правит миром**

*   **История:** Разработан компанией Intel в 1978 году для процессора **Intel 8086** (отсюда и название "x86"). Это было 16-битное ядро.
*   **Эволюция:**
    *   **80286:** Расширил возможности, оставаясь 16-битным.
    *   **80386 (i386):** Ключевой момент! Стал полностью **32-битным**. Набор команд стал называться **IA-32 (Intel Architecture - 32-bit)**. Это та самая архитектура, которая доминировала в мире ПК с 1990-х до середины 2000-х.
*   **Особенности:**
    *   **CISC (Complex Instruction Set Computer):** Архитектура со *сложным* набором команд.
    *   **Принцип CISC:** "Одна сложная команда делает много работы". Команды имеют разную длину, и одна команда может выполнить сложное действие, для которого в других архитектурах потребовалось бы несколько команд (например, работа с строками в памяти).
    *   **Недостаток CISC:** Сложные команды трудно распараллелить и они выполняются за разное количество тактов.
*   **Современность:** Несмотря на возраст, x86 (и его 64-битное расширение **x86-64** или **AMD64**) до сих пор является доминирующей архитектурой для настольных ПК, ноутбуков и серверов. Это пример феноменальной обратной совместимости.

---

#### **4. Проблема: А как же дроби? x87 FPU**

Ранние процессоры x86 (8086, 80286) отлично работали с целыми числами, но **очень плохо справлялись с вычислениями с плавающей точкой** (дробями), которые критически важны для научных расчётов, инженерных задач и компьютерной графики.

**Решение:** Вынести сложные математические операции в **отдельное устройство** — **сопроцессор**.

*   **x87** — это не отдельный процессор, а **набор команд** для работы с числами с плавающей точкой.
*   **Математический сопроцессор (FPU - Floating Point Unit)** — это отдельный чип, который физически устанавливался на материнскую плату рядом с основным CPU и умел выполнять команды из набора x87.

**Как это работало:**
1.  Основной процессор (x86) встречал в программе команду вроде `FADD` (сложить числа с плавающей точкой).
2.  Он пересылал данные и саму команду сопроцессору.
3.  Пока сопроцессор производил вычисления, основной процессор мог продолжать выполнять целочисленные операции.
4.  Результат забирался из сопроцессора.

*   **История:** Сопроцессоры для x86 назывались 8087, 80287, 80387. Они были дорогим, но очень желанным апгрейдом для учёных и инженеров.

---

#### **5. Интеграция: От отдельного чипа к ядру внутри CPU**

С развитием технологий стало возможным размещать миллионы транзисторов на одном кристалле.

*   **Intel 80486DX (1989 год) — революция!**
    *   Математический сопроцессор (FPU) был **интегрирован прямо в ядро основного процессора**.
    *   Теперь набор команд x87 стал частью общего набора команд процессора x86.
    *   Это резко увеличило скорость математических расчётов, так как исчезла необходимость в медленной пересылке данных между двумя чипами.

**С этого момента понятия "x86" и "x87" стали неразрывны.** Любой современный x86-процессор имеет внутри себя блок FPU, умеющий выполнять команды x87.

---

#### **6. Итог: Краткая хронология и связка x86/x87**

| Поколение | Основной CPU | Сопроцессор (FPU) | Ключевое свойство |
| :--- | :--- | :--- | :--- |
| **8086/8088** | x86 (целые) | **Отсутствует** / 8087 (отдельный чип) | Раздельное существование |
| **80286** | x86 (целые) | **Отсутствует** / 80287 (отдельный чип) | Раздельное существование |
| **80386** | x86 (целые, 32-бит) | **Отсутствует** / 80387 (отдельный чип) | Раздельное существование |
| **80486SX** | x86 (целые) | **Отсутствует** (искусственно отключен) | Маркетинг, сегментация |
| **80486DX** | x86 (целые) + **x87 (FPU)** | **Интегрирован в один чип** | Начало эры единого CPU |
| **Pentium и новее**| x86 (целые) + **x87 (FPU)** + новые расширения (MMX, SSE...) | **Неотъемлемая часть ядра** | Стандарт |

---

#### **7. Заключение и связь с современностью**

*   **ISA x86/x87** — это исторический фундамент, на котором построены все современные процессоры для ПК.
*   Набор x87 сегодня считается **устаревшим (legacy)**, но до сих пор поддерживается для обратной совместимости.
*   Его сменили более современные и эффективные наборы команд для вычислений с плавающей точкой и векторных операций: **SSE, AVX**. Они используют отдельные, более широкие регистры и команды, лучше приспособленные для параллелизма.

**Таким образом, эволюция выглядит так:**
**Отдельный сопроцессор (x87) → Интегрированный FPU (x87) → Специализированные векторные расширения (SSE, AVX)**

---

**Домашнее задание / Вопросы для самоконтроля:**
1.  Дайте определение ISA. Почему его называют "договором" между железом и софтом?
2.  Объясните разницу между CISC и RISC (можете провести небольшое исследование). К какому типу относится x86?
3.  Какова была основная причина появления математического сопроцессора и набора команд x87?
4.  Какой процессор стал переломным моментом, объединив x86 и x87 в одном кристалле, и к каким преимуществам это привело?