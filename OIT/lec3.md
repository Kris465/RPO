# **Python и ОС I.** Модуль `os` и `pathlib`. Автоматизация работы с файлами и директориями: создание, удаление, поиск, организация проектов скриптами.

## Ссылки для второго курса:
python os - https://docs.python.org/3/library/os.html
python pathlib - https://docs.python.org/3/library/pathlib.html#module-pathlib

## Первый курс:
1. Знакомство с vs code
2. Знакомство с системой git
3. Знакомство с python (переменные, типы данных, базовая работа с файлами)
4. Работа с текстовыми файлами (txt, json)
5. Функции строк

### Шпаргалка:
Отлично! Вот шпаргалка-конспект для первокурсников, который можно раздать или показать на экране. Всё с примерами и пояснениями.

---

### Шпаргалка по Python для начинающих

#### 3. Знакомство с Python: переменные, типы данных, базовая работа с файлами

**Переменные** — это как коробки с названиями, где хранятся данные.
```python
name = "Анна"  # Текст (строка)
age = 20       # Целое число
height = 1.75  # Дробное число
is_student = True # Логический тип (True/False)
```

**Основные типы данных:**
*   `str` (строка) — текст в кавычках: `"Привет"`, `'файл.txt'`
*   `int` (целое число) — `10`, `-5`, `0`
*   `float` (дробное число) — `3.14`, `-0.001`
*   `bool` (логический) — `True`, `False`
*   `list` (список) — упорядоченный набор элементов: `[1, 2, 3]`, `['a', 'b']`

**Базовые операции:**
```python
# Математика
a = 10 + 5   # Сложение (15)
b = 10 * 2   # Умножение (20)
c = 10 / 3   # Деление (3.333...)

# Со строками
name = "Анна"
greeting = "Привет, " + name  # Конкатенация ("Привет, Анна")
```

**Базовая работа с файлами (чтение и запись):**
```python
# 1. Запись в файл
file = open("test.txt", "w", encoding="utf-8") # 'w' - запись (write)
file.write("Первая строка\n") # \n - перенос строки
file.write("Вторая строка")
file.close() # Важно закрывать файл!

# 2. Чтение из файла
file = open("test.txt", "r", encoding="utf-8") # 'r' - чтение (read)
content = file.read() # Читает ВЕСЬ файл в одну строку
print(content)
file.close()

# 3. Лучший способ (with) - файл закроется сам!
with open("test.txt", "r", encoding="utf-8") as file:
    content = file.read()
    print(content)
# Здесь файл уже закрыт автоматически
```

---

#### 4. Работа с текстовыми файлами (txt, json)

**Чтение построчно:**
```python
with open("book.txt", "r", encoding="utf-8") as file:
    lines = file.readlines() # Читает все строки в список

    for line in lines:
        print(line.strip()) # .strip() убирает лишние пробелы и переносы
```

**Работа с JSON (для хранения структур данных):**
```python
import json #必须 импортировать модуль!

# Данные для сохранения (словарь и список)
data = {
    "name": "Иван",
    "age": 20,
    "courses": ["Python", "Math"]
}

# 1. Запись в JSON файл
with open("data.json", "w", encoding="utf-8") as file:
    json.dump(data, file, ensure_ascii=False) # ensure_ascii=False для кириллицы

# 2. Чтение из JSON файла
with open("data.json", "r", encoding="utf-8") as file:
    loaded_data = json.load(file) # Загружаем данные обратно

print(loaded_data["name"]) # "Иван"
print(loaded_data["courses"]) # ["Python", "Math"]
```

---

#### 5. Функции строк

**Основные методы (что можно делать со строками):**

```python
text = "Python и разработка программного обеспечения"

# 1. Преобразование регистра
print(text.upper())   # "PYTHON И РАЗРАБОТКА ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ"
print(text.lower())   # "python и разработка программного обеспечения"
print(text.title())   # "Python И Разработка Программного Обеспечения"

# 2. Поиск и замена
print("разработка" in text)  # True (проверка наличия подстроки)
print(text.find("и"))        # 7 (индекс первого вхождения)
new_text = text.replace("ПО", "программного обеспечения") # Замена

# 3. Разделение и склейка
words = text.split(" ") # Разделить по пробелам на список слов
# ['Python', 'и', 'разработка', 'программного', 'обеспечения']
new_text = "-".join(words) # Склеить список через дефис
# "Python-и-разработка-программного-обеспечения"

# 4. Срезы (получение части строки)
# str[начало:конец:шаг]
print(text[0:6])   # "Python" (символы с 0 по 5)
print(text[7:8])   # "и" (символ с индексом 7)
print(text[::-1])  # "инечинебсо огоммаргорп актаборзар и nohtyP" (перевернутая)

# 5. Проверки
print("python".isalpha())   # True (только буквы?)
print("123".isdigit())      # True (только цифры?)
print("   ".isspace())      # True (только пробелы?)
```

**Ф-строки (f-strings) — современный способ форматирования:**
```python
name = "Мария"
age = 19

# Вместо: "Привет, " + name + ", тебе " + str(age) + " лет"
message = f"Привет, {name}, тебе {age} лет. Через год будет {age + 1}."
print(message) # "Привет, Мария, тебе 19 лет. Через год будет 20."
```

---

### Задания для практики (первый курс):

1.  **Переменные:** Создай переменные для своего имени, возраста и любимого предмета. Выведи их одной фразой с помощью f-строки.
2.  **Файлы:** Создай файл `my_info.txt` и запиши в него 3 факта о себе.
3.  **Строки:** Прочитай файл `my_info.txt`, переведи весь текст в верхний регистр и запиши результат в новый файл `shout_info.txt`.
4.  **JSON:** Создай словарь с данными о своем домашнем животном (или желаемом питомце): кличка, вид, возраст. Сохрани его в JSON-файл.

---

### Задача 1: «Анализатор кодовой базы»

**Цель:** Разработать скрипт, который собирает подробную статистику по исходному коду в указанной директории (например, клонированному репозиторию). Результат должен быть представлен в виде понятного текстового отчета и сохранен в JSON-файл.

#### Техническое задание:

**Входные данные:**
*   Путь к корневой директории проекта (`project_path`).
*   (Опционально) Список интересующих расширений файлов (по умолчанию: `['.py', '.js', '.java', '.cpp', '.c', '.html', '.css', '.md']`).

**Требуемая функциональность:**
1.  **Рекурсивный обход:** Скрипт должен обойти все файлы и папки в `project_path`, включая вложенные.
2.  **Фильтрация по типу:** Анализировать только файлы с указанными расширениями.
3.  **Сбор статистики для каждого файла:**
    *   Размер файла в КБ.
    *   Количество строк кода.
    *   (Со звездочкой) Приблизительное количество логических строк кода (игнорируя пустые строки и строки только с комментариями).
4.  **Агрегация статистики по проекту:**
    *   Общее количество файлов каждого типа.
    *   Общее количество строк кода для каждого типа.
    *   Среднее количество строк в файле для каждого типа.
    *   Самый большой файл (по количеству строк) и его путь.
    *   Общий размер исходного кода проекта в МБ.
5.  **Формирование отчета:**
    *   Вывести сводку в консоль в удобочитаемом виде.
    *   Сохранить детальную статистику (включая данные по каждому файлу) в JSON-файл `code_analysis_report.json`.

**Требования к реализации:**
*   Использовать `pathlib` для работы с путями.
*   Использовать методы строк для обработки имен файлов и анализа расширений.
*   Запрещено использовать сложные регулярные выражения для анализа кода.

**Пример вывода в консоль:**
```
[Анализ кодовой базы проекта: /home/user/projects/awesome-project]
==========================================================

Общая статистика:
• Всего файлов с кодом: 152
• Общий объем кода: 2.8 MB
• Общее количество строк: 15 430

Детали по типам файлов:
[Python] (.py)
  Файлов: 45, Строк: 8 921, Средний размер: 198.2 строк/файл
  Самый большой файл: /src/core/engine.py (1 205 строк)

[JavaScript] (.js)
  Файлов: 32, Строк: 4 105, Средний размер: 128.2 строк/файл
...
```

---

### Задача 2: «Организатор папки "Загрузки"»

**Цель:** Разработать скрипт для автоматической сортировки файлов в указанной директории (по умолчанию — папка "Загрузки" пользователя) по категориям.

#### Техническое задание:

**Входные данные:**
*   (Опционально) Путь к целевой директории для сортировки. По умолчанию — путь к папке "Загрузки" текущего пользователя (`Path.home() / "Downloads"`).

**Требуемая функциональность:**
1.  **Сканирование:** Получить список всех файлов в целевой директории. *Внимание:* папки обрабатывать не нужно.
2.  **Классификация:** Определить категорию для каждого файла на основе его расширения (свойство `.suffix`).
3.  **Определение категорий:** Использовать заранее заданный словарь. Пример:
    ```python
    CATEGORIES = {
        "Images": [".jpg", ".jpeg", ".png", ".gif", ".bmp", ".svg", ".webp"],
        "Documents": [".pdf", ".docx", ".doc", ".txt", ".xlsx", ".pptx", ".md", ".rtf"],
        "Archives": [".zip", ".rar", ".7z", ".tar", ".gz", ".dmg"],
        "Audio": [".mp3", ".wav", ".flac", ".aac", ".m4a"],
        "Video": [".mp4", ".mov", ".avi", ".mkv", ".wmv", ".flv"],
        "Code": [".py", ".js", ".html", ".css", ".java", ".cpp", ".c", ".php", ".json"],
        "Scripts": [".exe", ".msi", ".bat", ".sh", ".deb"],
        "Torrents": [".torrent"],
    }
    ```
4.  **Создание структуры папок:** Для каждой категории из словаря создать соответствующую папку внутри целевой директории, если её ещё не существует.
5.  **Перемещение файлов:** Аккуратно переместить каждый файл в папку его категории.
    *   **Важно!** Если файл с таким именем уже существует в папке назначения, не перезаписывать его, а изменить имя перемещаемого файла (добавить суффикс, например, `_1`, `_2`).
6.  **Файлы без категории:** Все файлы, расширение которых не указано в словаре, переместить в папку `"Other"`.
7.  **Логирование:** Записать в файл `downloads_organizer.log` действия скрипта: какие файлы и куда были перемещены, какие ошибки возникли (например, нет прав на перемещение).

**Требования к реализации:**
*   Использовать `pathlib` для всех операций с путями.
*   Использовать методы строк для обработки имен файлов.
*   Обеспечить безопасность: не удалять файлы, только перемещать.

**Пример работы:**
*   До: `~/Downloads/` [report.pdf, cat.jpg, project.zip, script.py, unknown.xyz]
*   После: `~/Downloads/` будет содержать папки: `Documents/`, `Images/`, `Archives/`, `Code/`, `Other/`.
    *   `Documents/report.pdf`
    *   `Images/cat.jpg`
    *   `Archives/project.zip`
    *   `Code/script.py`
    *   `Other/unknown.xyz`