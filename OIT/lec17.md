### **Конспект лекции №17**
**Дисциплина:** Основы информационных технологий
**Тема:** Корреляция пропускной способности шины памяти и системной шины

---

#### **1. Введение: Проблема «бутылочного горлышка»**

Представьте мощный процессор (ЦП) как супер-быстрый шеф-повара, а оперативную память (ОЗУ) — как его холодильник с продуктами. Даже если повар работает молниеносно, он будет простаивать, если продукты из холодильника ему подвозят по узкому и медленному коридору.

**Шина** — это и есть тот самый «коридор» для передачи данных.
*   **Шина памяти** соединяет контроллер памяти и модули ОЗУ.
*   **Системная шина** (или шина процессора) соединяет процессор с северным мостом чипсета (или напрямую с контроллером памяти в современных ЦП).

Если пропускная способность (ПСП) одной шины значительно меньше другой, возникает **«бутылочное горлышко» (bottleneck)**, и более медленная шина не позволяет раскрыть потенциал более быстрого компонента.

---

#### **2. Ключевые понятия: Пропускная способность (ПСП)**

**Пропускная способность (Bandwidth)** — это максимальный объем данных, который можно передать по шине за единицу времени. Измеряется в гигабайтах в секунду (ГБ/с).

**Формула для расчета ПСП шины памяти:**
`ПСП (ГБ/с) = (Тактовая частота шины) × (Разрядность шины в байтах) × (Количество передач за такт)`

*   **Тактовая частота шины (МГц):** Базовая частота, на которой работает шина.
*   **Разрядность шины (биты):** Сколько бит данных передается за один раз. Для одного канала памяти DDR* это **64 бита = 8 байт**.
*   **Количество передач за такт:** Для DDR, DDR2, DDR3 это **2** (удвоенная скорость).

**Пример для DDR3-1600:**
*   Эффективная частота (Data Rate) = 1600 МТ/с
*   Тактовая частота шины = 800 МГц
*   Разрядность = 64 бита = 8 Байт
*   **ПСП = 800 МГц × 8 Б × 2 = 12 800 МБ/с = 12.8 ГБ/с**

---

#### **3. Системная шина и ее эволюция**

Исторически (во времена процессоров Intel Core 2 Duo) архитектура выглядела так:

**ЦП ←→ Системная шина (FSB - Front Side Bus) ←→ Северный мост ←→ Шина памяти ←→ ОЗУ**

*   **FSB** также работала с удвоенной скоростью (Quad Pumped, 4 передачи за такт).
*   **Возникала проблема:** ПСП шины памяти и ПСП FSB должны были быть сбалансированы. Если ПСП памяти была выше, чем могла "переварить" FSB, ее потенциал не использовался.

**Современная архитектура (со времен Intel Core i и AMD Athlon 64):**

В процессор **интегрирован контроллер памяти**. Теперь схема выглядит так:

**ЦП (с контроллером памяти) ←→ Шина памяти ←→ ОЗУ**

Это кардинально меняет ситуацию:
*   Исчезает одно звено (Северный мост) и одна потенциальная "пробка" (FSB).
*   Процессор общается с памятью **напрямую**, что резко снижает задержки.

---

#### **4. Корреляция и баланс в современной архитектуре**

Хотя прямой FSB больше нет, принцип корреляции никуда не делся. Теперь он проявляется в другом:

**1. Пропускная способность нескольких каналов памяти vs. Возможности контроллера внутри ЦП.**
*   Современные системы поддерживают **многоканальный режим** (2-, 4-, 8-канальный).
*   **Двухканальный режим:** Две 64-битных шины работают параллельно, что дает эффективную разрядность **128 бит**.
    *   ПСП (двухканальный) = ПСП (одного канала) × 2
    *   Пример: Для нашего DDR3-1600: 12.8 ГБ/с × 2 = **25.6 ГБ/с**
*   Контроллер памяти внутри процессора должен быть рассчитан на такую суммарную нагрузку.

**2. Внутренняя шина процессора (Uncore, Infinity Fabric).**
*   В современных процессорах (особенно у AMD Ryzen) связь между ядрами и контроллером памяти осуществляется по **внутренней высокоскоростной шине** (например, Infinity Fabric).
*   **Ключевой момент:** Частота этой внутренней шины часто **привязана к частоте оперативной памяти** (не к ее ПСП, а к реальной тактовой частоте, например, 1600 МГц для DDR3-1600 или 3200 МГц для DDR4-3200).
*   **Вывод:** Если вы устанавливаете медленную память, вы **замедляете не только обмен с ОЗУ, но и внутреннюю коммуникацию между ядрами процессора!** Это напрямую влияет на общую производительность.

---

#### **5. Практический пример и вывод**

**Ситуация:**
*   Процессор с двухканальным контроллером памяти, рассчитанный на работу с DDR4.
*   Вариант 1: Одна планка DDR4-2666 (одноканальный режим).
*   Вариант 2: Две планки DDR4-2666 (двухканальный режим).

**Разница:**
*   Вариант 1: ПСП = ~21.3 ГБ/с. Внутренняя шина ЦП работает на частоте 1333 МГц.
*   Вариант 2: ПСП = ~42.6 ГБ/с. Внутренняя шина ЦП работает на частоте 1333 МГц.
*   **Вариант 2 будет значительно производительнее** не только из-за удвоенной ПСП к памяти, но и потому, что ядра процессора быстрее обмениваются данными между собой.

**Общий вывод:**
В современной системе **быстрая и правильно сконфигурированная (многоканальная) память критически важна** для раскрытия потенциала процессора. Она не просто "дает ему данные", но и напрямую влияет на скорость его внутренней работы.

---

#### **6. Сравнительная таблица: Эволюция связи**

| Архитектура | Связь ЦП и ОЗУ | "Бутылочное горлышко" | Ключ к балансу |
| :--- | :--- | :--- | :--- |
| **Устаревшая (с FSB)** | ЦП → FSB → Северный мост → Шина ОЗУ | Пропускная способность FSB | Согласование ПСП FSB и ПСП памяти |
| **Современная (встроенный контроллер)** | ЦП **(контроллер)** → Шина ОЗУ | Скорость контроллера в ЦП и частота внутренней шины | Использование многоканальности и высокочастотной памяти |